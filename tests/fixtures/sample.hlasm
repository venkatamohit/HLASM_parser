* ============================================================
* SAMPLE HLASM PROGRAM
* Tests: CSECT, labeled blocks, BAL subroutine calls, data areas
* ============================================================
MAINPROG CSECT
         STM   14,12,12(13)     Save all registers
         BALR  12,0             Establish base register
         USING *,12
         ST    13,SAVEAREA+4    Save caller's save area address
         LA    13,SAVEAREA      Point to our save area
*
* Call first subroutine
         LA    1,INPUTPARM      Load parameter address
         BAL   14,PROCESS1      Call processing routine 1
*
* Call second subroutine
         LA    1,INPUTPARM
         BAL   14,PROCESS2      Call processing routine 2
*
* Return to caller
         L     13,SAVEAREA+4    Restore caller's save area
         LM    14,12,12(13)     Restore all registers
         BR    14               Return to caller
*
* ── Data areas ───────────────────────────────────────────────
SAVEAREA DC    18F'0'           18 fullwords for register save area
INPUTPARM DC   CL8'TESTDATA'   Input parameter area
OUTBUFF  DS    CL80             Output buffer (80 bytes)
*
* ============================================================
* Subroutine PROCESS1 – First processing routine
* ============================================================
PROCESS1 STM   14,12,12(13)
         BALR  12,0
         USING *,12
         ST    13,P1SAVE+4
         LA    13,P1SAVE
*
         MVC   OUTBUFF,INPUTPARM   Copy input to output
         LA    0,OUTBUFF
         LA    1,80
*
         L     13,P1SAVE+4
         LM    14,12,12(13)
         BR    14
*
P1SAVE   DC    18F'0'
*
* ============================================================
* Subroutine PROCESS2 – Second processing routine (with branches)
* ============================================================
PROCESS2 STM   14,12,12(13)
         BALR  12,0
         USING *,12
         ST    13,P2SAVE+4
         LA    13,P2SAVE
*
         CLC   INPUTPARM,=CL8'TESTDATA'
         BE    P2MATCH              Branch if equal
         B     P2NOMATCH            Branch if not equal
*
P2MATCH  DS    0H
         MVI   OUTBUFF,C'Y'
         B     P2EXIT
*
P2NOMATCH DS   0H
         MVI   OUTBUFF,C'N'
*
P2EXIT   DS    0H
         L     13,P2SAVE+4
         LM    14,12,12(13)
         BR    14
*
P2SAVE   DC    18F'0'
*
         END   MAINPROG
